.row
  .col-lg-12
    %h1 Your Cart
.row
  .col-lg-12
    %div{style: "overflow-x:auto;"}
      %table.table.table-hover
        %thead
          %tr
            %th Product
            %th Quantity
            %th.text-center Price
            %th.text-center Total
            %th  
        %tbody
          - @cart.items.each do |item|
            %tr
              %td.col-sm-8.col-md-6
                .media
                  = image_tag item.product.attachments.first, class: 'thumbnail pull-left media-object', width: '200'
                  %h4.media-heading
                    = link_to item.product.name, product_path(item.product.id)
                  %span Status:
                  %span.text-success
                    %strong= item.product.status
              %td= text_field_tag 'items[]', item.quantity, placeholder: "#{item.quantity}"
              %td= number_to_currency item.product.price
              %td= number_to_currency item.total_price
              %td= link_to "Remove from cart", remove_cart_path(item.product.id), method: :post, class: 'btn btn-danger'
          %tr
            %td  
            %td  
            %td  
            %td
              %h3 Total
            %td.text-right
              %h3
                %strong= number_to_currency @cart.total_price
          %tr
            %td  
            %td  
            %td  
            %td= link_to 'Continue Shopping',  root_path, class: 'btn btn-primary btn-large'
            %td
              - unless current_user.nil?
                - if current_user.check_nullity?
                  = link_to 'Update Account', auto_update_role_cart_url, method: :post, class: 'btn btn-lg btn-info'
                - else
                  = link_to '#', "data-toggle" => "modal", "data-target" => "#order-modal" do
                    .btn.btn-lg.btn-success Order!
              - else
                = link_to new_registration_path(User.new) do
                  .btn.btn-lg.btn-primary Sign Up!

- if current_user
  .modal.fade{role: 'dialog', id: 'order-modal'}
    = form_for @order_product, remote: true, data: { rel: "#modal-header", target: "#errors"} do |f|
      .modal-dialog.modal-md{role: 'document'}
        .modal-content
          .modal-header{id: "modal-header"}
            %button.close{type: 'button', "data-dismiss" => "modal", "aria-label" => "Close"}
              %span{"aria-hidden" => "true"}
                &times;
            %h2 Order Summary
          .modal-body
            %div{id: "errors"}
            %h2= "Total cost #{number_to_currency @cart.total_price} "
            = f.hidden_field :total, value: @cart.total_price
            %h3.center Item Infomation
            %br
            -# for display purposes only
            - @cart.items.each do |item|
              .row
                .col-sm-4
                .col-sm-4
                  %p
                    %strong
                      Quantity:
                      = item.quantity
                .col-sm-4
              .row
                .col-sm-4
                .col-sm-4
                  %p
                    %strong
                      Product Name:
                      = item.product.name
                .col-sm-4
              .row
                .col-sm-4
                .col-sm-4
                  %p
                    %strong
                      =image_tag item.product.attachments.first, width: '200'
                .col-sm-4
              .row
                .col-sm-4
                .col-sm-4
                  %p
                    %strong
                      Total price:
                      = number_to_currency item.total_price
                .col-sm-4
              %br
            %i NOTE: current we do not ship items, your items will be placed in your room or you must pick them up
            .modal-footer
              = f.submit 'Place Order', class: 'btn btn-success'
              %button.btn.btn-default{"data-dismiss" => "modal", :type => "button"} Close
